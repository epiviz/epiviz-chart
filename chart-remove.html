<!-- External Polymer Styles/elements dependency -->
<link rel="import" href="../paper-icon-button/paper-icon-button.html">

<!-- Epiviz element dependency -->

<script>
    /**
     * `ChartRemoveBehavior` object manages the `<epiviz-chart-remove>` element for each chart. 
     * All charts inherit this behavior to remove itself from DOM.
     *
     * @polymerBehavior
    **/
    epiviz.ChartRemoveBehavior = {

        /**
         * Shows the remove element
         */
        _showRemoveDialog: function () {
            var self = this;
            // Polymer.dom(self).remove();

            if (self._parentContainer) {
                Polymer.dom(self._parentContainer).removeChild(self);

                var navChildren = self._parentContainer.getEffectiveChildren().length;
                for (var nindex = 0; nindex < navChildren; nindex++) {
                    var child = self._parentContainer.getEffectiveChildren()[nindex];
                    if (child.plotId == self.plotId) {
                        $(self._parentContainer.getEffectiveChildren()[nindex]).remove();
                        $("[plot-id=" + self.plotId + "]").remove();
                    }
                }
            }
            else {
                $(self.root).remove();
                $("[plot-id=" + self.plotId + "]").remove();
            }
        },

        /**
         * Initializes the `<epiviz-chart-remove>` element
         */
        _initializeRemoveDialog: function () {
            var chartSettingsContainer = this.$$('#chartSettingsContainer');
            var chartContainer = this.$$('#' + this.plotId);
            var currSettingIcon = this.$$('#chartRemoveIcon');

            if (currSettingIcon == null) {
                var iconElem = document.createElement('paper-icon-button');
                iconElem.id = "chartRemoveIcon";
                iconElem.icon = "icons:remove-circle";

                iconElem.addEventListener("click", this._showRemoveDialog.bind(this));

                Polymer.dom(chartSettingsContainer).appendChild(iconElem);
            }
        }
    }
</script>